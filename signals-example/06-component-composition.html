<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Component Composition Example</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .card {
      border: 2px solid #007bff;
      border-radius: 8px;
      padding: 20px;
      margin: 10px;
      background: #f8f9fa;
    }
    .card h3 {
      margin-top: 0;
      color: #007bff;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 14px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #28a745;
      color: white;
    }
    button:hover {
      background: #218838;
    }
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Component Composition Example</h1>
    <p>Demonstrates composing multiple components together and passing props.</p>
    <div id="app"></div>
  </div>

  <script type="module">
    import { createSignal, createComponent, html, render } from '../index.js';

    // Button Component
    const Button = createComponent((props) => {
      return html`
        <button 
          style="background: ${props.color || '#007bff'};"
          onclick="${props.onClick || (() => {})}"
        >
          ${props.label || 'Click me'}
        </button>
      `;
    });

    // Card Component
    const Card = createComponent((props) => {
      return html`
        <div class="card" style="border-color: ${props.borderColor || '#007bff'};">
          <h3>${props.title || 'Card'}</h3>
          <div>${props.children || 'No content'}</div>
        </div>
      `;
    });

    // Counter Component
    const Counter = createComponent((props) => {
      const [count, setCount] = createSignal(props.initialValue || 0);
      
      return html`
        <div>
          <p style="font-size: 32px; font-weight: bold; color: #007bff;">
            ${count()}
          </p>
          <Button label="Increment" color="#28a745" onClick="${() => setCount(c => c + 1)}" />
          <Button label="Decrement" color="#dc3545" onClick="${() => setCount(c => c - 1)}" />
          <Button label="Reset" color="#6c757d" onClick="${() => setCount(props.initialValue || 0)}" />
        </div>
      `;
    });

    // Timer Component
    const Timer = createComponent(() => {
      const [seconds, setSeconds] = createSignal(0);
      const [isRunning, setIsRunning] = createSignal(false);
      
      let intervalId = null;
      
      if (isRunning()) {
        intervalId = setInterval(() => {
          setSeconds(s => s + 1);
        }, 1000);
      }
      
      return html`
        <div>
          <p style="font-size: 32px; font-weight: bold; color: #28a745;">
            ${seconds()}s
          </p>
          <Button 
            label="${isRunning() ? 'Pause' : 'Start'}" 
            color="${isRunning() ? '#ffc107' : '#28a745'}"
            onClick="${() => setIsRunning(!isRunning())}"
          />
        </div>
      `;
    });

    // Main Dashboard Component
    const Dashboard = createComponent(() => {
      const [showCounter, setShowCounter] = createSignal(true);
      const [showTimer, setShowTimer] = createSignal(true);

      return html`
        <div>
          <div class="dashboard">
            <Card title="Counter Widget" borderColor="#007bff">
              ${showCounter() 
                ? '<Counter initialValue="5" />'
                : '<p style="color: #999;">Counter hidden</p>'
              }
              <Button 
                label="${showCounter() ? 'Hide Counter' : 'Show Counter'}" 
                color="#6c757d"
                onClick="${() => setShowCounter(!showCounter())}"
              />
            </Card>

            <Card title="Timer Widget" borderColor="#28a745">
              ${showTimer() 
                ? '<Timer />'
                : '<p style="color: #999;">Timer hidden</p>'
              }
              <Button 
                label="${showTimer() ? 'Hide Timer' : 'Show Timer'}" 
                color="#6c757d"
                onClick="${() => setShowTimer(!showTimer())}"
              />
            </Card>

            <Card title="Info" borderColor="#ffc107">
              <p>This dashboard demonstrates:</p>
              <ul>
                <li>Component composition</li>
                <li>Props passing</li>
                <li>Nested components</li>
                <li>Conditional rendering</li>
              </ul>
            </Card>
          </div>
        </div>
      `;
    });

    // Register components for use in templates
    const dashboard = Dashboard();
    dashboard.registerComponent('Button', Button);
    dashboard.registerComponent('Card', Card);
    dashboard.registerComponent('Counter', Counter);
    dashboard.registerComponent('Timer', Timer);
    
    render(Dashboard, document.getElementById('app'));
  </script>
</body>
</html>

